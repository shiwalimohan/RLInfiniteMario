sp {mario*elaborate*monster
   (state <s> ^io.input-link.monsters.monster <m>
              ^name mario-soar)
   -(<m> ^type |Mario|)
-->
   (<s> ^monster <m>)
}

sp {mario*elaborate*monster-distance
   (state <s> ^mario <mario>
              ^monster <ob>)
   (<mario> ^x <mariox>
            ^y <marioy>)
   (<ob> ^x <obx>
         ^y <oby>)
-->
   (<ob> ^distx (- <obx> <mariox>)
         ^disty (- <oby> <marioy>))
}

sp {mario*elaborate*monster2
   (state <s> ^monster <m>)
  -(<m> ^type |Fireball|)
   (<m> ^distx < 6
       ^disty < 5)
   -(<m> ^distx < -4)
   -(<m> ^disty < -2)
-->
   (<m> ^isthreat yes)
}

sp {mario*elaborate*monster*surrounding*tiles
   (state <s> ^name mario-soar
              ^monster <m>)
   (<m> ^x <mx>
        ^y <my>)
-->
   (<m> ^top-right <tr>
        ^top <t>
        ^top-left <tl>
        ^left <l>
        ^right <r>
        ^bottom <b>
        ^bottom-right <br>
        ^bottom-left <bl>)
  (<tr> ^x (+ <mx> 1)
         ^y (+ <my> 1))
  (<tl> ^x (- <mx> 1) 
         ^y (+ <my> 1))
  (<t> ^x (+ <mx> 0)
         ^y (+ <my> 1))
  (<l> ^x (- <mx> 1)
       ^y (+ <my> 0))
  (<r> ^x (+ <mx> 1)
         ^y (+ <my> 0))
  (<br> ^x (+ <mx> 1)
         ^y (- <my> 1))
  (<bl> ^x (- <mx> 1)
         ^y (- <my> 1))
  (<b> ^x (+ <mx> 0)
         ^y (- <my> 1))
}

sp {mario*elaborate*monster*surrounding*top-right
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top-right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
           ^type << |4| |2| |6| |5| |3| |7| |?| >> )
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*top-right*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top-right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
           ^type << |0| |1| | | >> )
-->
   (<t> ^isblocked false)
}

sp {mario*elaborate*monster*surrounding*top-left
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top-left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |4| |2| |6| |5| |3| |7| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*top-left*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top-left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |0| |1| | | >>)
-->
   (<t> ^isblocked false)
}


sp {mario*elaborate*monster*surrounding*bottom-right
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom-right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |4| |6| |3| |7| |1| |5| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*bottom-right*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom-right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |2| |0| | | >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*bottom-left
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom-left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
           ^type << |4| |6| |3| |7| |1| |5| |?| >>)
-->
   (<t> ^isblocked true)
}


sp {mario*elaborate*monster*surrounding*bottom-left*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom-left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
           ^type << |2| |0| | | >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*top
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |2| |6| |3| |7| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*top*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^top <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |1| |4| |5| |0| | | >>)
-->
   (<t> ^isblocked false)
}

sp {mario*elaborate*monster*surrounding*bottom
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |1| |5| |3| |7| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*bottom*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^bottom <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |2| |4| |6| |0| | | >>)
-->
   (<t> ^isblocked false)
}

sp {mario*elaborate*monster*surrounding*left
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |4| |6| |7| |5| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*left*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^left <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |0| |1| |2| |3| | | >>)
-->
   (<t> ^isblocked false)
}


sp {mario*elaborate*monster*surrounding*right
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |4| |6| |7| |5| |?| >>)
-->
   (<t> ^isblocked true)
}

sp {mario*elaborate*monster*surrounding*right*b
   (state <s> ^name mario-soar
              ^monster <m>
              ^io.input-link.visual-scene.tile-row <row>)
   (<m> ^right <t>)
   (<t> ^x <tx>
        ^y <ty>)
   (<row> ^tile <tile>
         ^y <ty>)
   (<tile> ^x <tx>
          ^type << |0| |1| |2| |3| | | >>)
-->
   (<t> ^isblocked false)
}